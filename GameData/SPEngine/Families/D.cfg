SPEFamily:NEEDS[RealFuels]
{
	letter = D
	description = Pressure-fed hypergolic vacuum engine, like AJ10 family (Able, Delta, Apollo SPS...).
	minTf = 0.25
	minIgnitions = 1
	TechLevel
	{
		// AJ10-37
		techRequired = orbitalRocketry1956
		maxThrust = 42
		isp
		{
			key = 0 271
			key = 1 240
		}
		PROPELLANT
		{
			name = UDMH
			ratio = 0.406
			DrawGauge = True
		}
		PROPELLANT
		{
			name = IWFNA
			ratio = 0.594
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 0.2
		}
		pressureFed = true
		maxIgnitions = 1
		mass = 0.1
		entryCost = 6150 // original is 8000, AJ10-27.  For now we'll just assume you've unlocked the -27 or equivalent proc-B.
		cost = 200
		toolCost = 2400 // yields 1849 for an AJ10-27
	}
	TechLevel
	{
		// AJ10-42
		techRequired = orbitalRocketry1958
		maxThrust = 44
		isp
		{
			key = 0 267
			key = 1 238
		}
		PROPELLANT
		{
			name = UDMH
			ratio = 0.406
			DrawGauge = True
		}
		PROPELLANT
		{
			name = IWFNA
			ratio = 0.594
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 0.2
		}
		pressureFed = true
		maxIgnitions = 1
		mass = 0.101
		entryCost = 1200 // 2000
		cost = 190
		toolCost = 2950 // yields 794 to upgrade from an AJ10-37
	}
	TechLevel
	{
		// AJ10-101A
		techRequired = orbitalRocketry1959
		maxThrust = 46
		isp
		{
			key = 0 270
			key = 1 240
		}
		PROPELLANT
		{
			name = UDMH
			ratio = 0.406
			DrawGauge = True
		}
		PROPELLANT
		{
			name = IWFNA
			ratio = 0.594
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 0.2
		}
		pressureFed = true
		maxIgnitions = 1
		mass = 0.1032
		entryCost = 600 // 1000
		cost = 220
		toolCost = 2880 // yields 400.7 to continue upgrading from AJ10-37
	}
	TechLevel
	{
		// AJ10-142
		techRequired = orbitalRocketry1960
		maxThrust = 48
		isp
		{
			key = 0 270
			key = 1 240
		}
		PROPELLANT
		{
			name = UDMH
			ratio = 0.406
			DrawGauge = True
		}
		PROPELLANT
		{
			name = IWFNA
			ratio = 0.594
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 0.2
		}
		pressureFed = true
		maxIgnitions = 1
		mass = 0.105
		entryCost = 1000 // 1500, AJ10-42
		cost = 225
		toolCost = 2950 // yields 498 to continue upgrading from AJ10-37
	}
	TechLevel
	{
		// AJ10-104 (but without the unlimited ignitions)
		techRequired = orbitalRocketry1961
		maxThrust = 50
		isp
		{
			key = 0 278
			key = 1 215
		}
		PROPELLANT
		{
			name = UDMH
			ratio = 0.4281
			DrawGauge = True
		}
		PROPELLANT
		{
			name = IRFNA-III
			ratio = 0.5719
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 0.2
		}
		pressureFed = true
		maxIgnitions = 4
		mass = 0.1194
		entryCost = 12000 // 25000, AJ10-101A.  But we don't have unl. ignitions
		cost = 384
		toolCost = 6250 // yields 2997 to continue upgrading from AJ10-37
	}
	TechLevel
	{
		// AJ10-138
		techRequired = orbitalRocketry1964
		maxThrust = 52
		isp
		{
			key = 0 311
			key = 1 100
		}
		PROPELLANT
		{
			name = Aerozine50
			ratio = 0.446
			DrawGauge = True
		}
		PROPELLANT
		{
			name = NTO
			ratio = 0.554
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 0.2
		}
		pressureFed = true
		maxIgnitions = 4
		mass = 0.149
		entryCost = 3000 // 5000, AJ10-101A
		cost = 475
		toolCost = 7600 // yields 2003 to continue upgrading from AJ10-37
	}
	TechLevel
	{
		// AJ10-118F
		techRequired = orbitalRocketry1972
		maxThrust = 54
		isp
		{
			key = 0 315
			key = 1 215
		}
		PROPELLANT
		{
			name = Aerozine50
			ratio = 0.4654
			DrawGauge = True
		}

		PROPELLANT
		{
			name = NTO
			ratio = 0.5346
			DrawGauge = False
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 0.2
		}
		pressureFed = true
		maxIgnitions = 16 // practically infinite
		mass = 0.121
		entryCost = 12000 // 3000, AJ10-118E
		cost = 472
		toolCost = 10000 // yields 3020.5 to continue upgrading from AJ10-37
	}
	TechLevel
	{
		// AJ10-118K
		techRequired = orbitalRocketry1986
		maxThrust = 56
		isp
		{
			key = 0 319.2
			key = 1 215
		}
		PROPELLANT
		{
			name = Aerozine50
			ratio = 0.4654
			DrawGauge = True
		}

		PROPELLANT
		{
			name = NTO
			ratio = 0.5346
			DrawGauge = False
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 0.2
		}
		pressureFed = true
		maxIgnitions = 16
		mass = 0.122
		entryCost = 3000 // 5000, AJ10-118F
		cost = 540
		toolCost = 10600 // yields 2003.4 to continue upgrading from AJ10-37
	}
}

@PART[*]:HAS[@MODULE[ModuleSPEngine]:HAS[#familyLetter[D]],!MODULE[TestFlightInterop]]:BEFORE[zTestFlight]
{
	!TESTFLIGHT,*{}
	TESTFLIGHT
	{
		name = SPEngine-D-0 // based on AJ10-37
		ratedBurnTime = 115
		ignitionReliabilityStart = 0.70
		ignitionReliabilityEnd = 0.85
		cycleReliabilityStart = 0.75
		cycleReliabilityEnd = 0.92 // even on its best day, not a reliable engine.

		// transfer from both Aerobee and proc B
		techTransfer = SPEngine-B-2,SPEngine-B-1,SPEngine-B-0:10&AJ10-27,XASR-1,WAC-Corporal:10
	}
	TESTFLIGHT
	{
		name = SPEngine-D-1 // based on AJ10-42
		ratedBurnTime = 150
		ignitionReliabilityStart = 0.85
		ignitionReliabilityEnd = 0.95
		cycleReliabilityStart = 0.79
		cycleReliabilityEnd = 0.95 // Thor-Able I was pretty good.

		techTransfer = SPEngine-D-0:50&AJ10-37:25
	}
	TESTFLIGHT
	{
		name = SPEngine-D-2 // based on AJ10-101A
		ratedBurnTime = 150
		ignitionReliabilityStart = 0.94
		ignitionReliabilityEnd = 0.98
		cycleReliabilityStart = 0.92
		cycleReliabilityEnd = 0.96

		techTransfer = SPEngine-D-1,SPEngine-D-0:50&AJ10-42,AJ10-37:25
	}
	TESTFLIGHT
	{
		name = SPEngine-D-3 // based on AJ10-142, but with techTransfer from the D-2 even though the -142 doesn't transfer from the -101A.
		ratedBurnTime = 150
		ignitionReliabilityStart = 0.94
		ignitionReliabilityEnd = 0.98
		cycleReliabilityStart = 0.92
		cycleReliabilityEnd = 0.96

		techTransfer = SPEngine-D-2,SPEngine-D-1,SPEngine-D-0:50&AJ10-42,AJ10-37:25
	}
	TESTFLIGHT
	{
		name = SPEngine-D-4 // based on AJ10-104
		ratedBurnTime = 300
		ignitionReliabilityStart = 0.93
		ignitionReliabilityEnd = 0.97
		ignitionDynPresFailMultiplier = 0.1
		cycleReliabilityStart = 0.91
		cycleReliabilityEnd = 0.95

		techTransfer = SPEngine-D-3,SPEngine-D-2,SPEngine-D-1,SPEngine-D-0:50&AJ10-142,AJ10-42,AJ10-37:25
	}
	TESTFLIGHT
	{
		name = SPEngine-D-5 // should be based on AJ10-138 but that has no TF config, so stealing some numbers from AJ10-118E
		ratedBurnTime = 440 // http://www.astronautix.com/a/aj10-138.html
		ignitionReliabilityStart = 0.96
		ignitionReliabilityEnd = 0.99
		ignitionDynPresFailMultiplier = 0.1
		cycleReliabilityStart = 0.94
		cycleReliabilityEnd = 0.985
		// only need to keep 4 generations as our generation penalty is 25%
		techTransfer = SPEngine-D-4,SPEngine-D-3,SPEngine-D-2,SPEngine-D-1:50&AJ10-104,AJ10-142,AJ10-42,AJ10-37:25
		reliabilityDataRateMultiplier = 2
	}
	TESTFLIGHT
	{
		name = SPEngine-D-6 // should be based on AJ10-118F but that has no TF config, so making up numbers from whole cloth
		ratedBurnTime = 335 // http://www.astronautix.com/a/aj10-118f.html
		// Generally about half the failure chances of the D-5
		// That makes for a pretty reliable engine, though not the perfect reliability we give the -118F in-game
		ignitionReliabilityStart = 0.98
		ignitionReliabilityEnd = 0.995
		ignitionDynPresFailMultiplier = 0.1
		cycleReliabilityStart = 0.97
		cycleReliabilityEnd = 0.992
		techTransfer = SPEngine-D-5,SPEngine-D-4,SPEngine-D-3,SPEngine-D-2:50&AJ10-104,AJ10-142,AJ10-42:15
		reliabilityDataRateMultiplier = 2
	}
	TESTFLIGHT
	{
		name = SPEngine-D-7 // should be based on AJ10-118K but that has no TF config, so making up numbers from whole cloth
		ratedBurnTime = 444 // http://www.astronautix.com/a/aj10-118k.html
		// Generally about half the failure chances of the D-6
		// That makes for a very reliable engine, though not the perfect reliability we give the -118K in-game
		ignitionReliabilityStart = 0.99
		ignitionReliabilityEnd = 0.9975
		ignitionDynPresFailMultiplier = 0.1
		cycleReliabilityStart = 0.985
		cycleReliabilityEnd = 0.996
		techTransfer = SPEngine-D-6,SPEngine-D-5,SPEngine-D-4,SPEngine-D-3:50&AJ10-104,AJ10-142,AJ10-42:10
		reliabilityDataRateMultiplier = 2
	}
}
