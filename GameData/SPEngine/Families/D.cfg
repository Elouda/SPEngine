SPEFamily:NEEDS[RealFuels]
{
	letter = D
	description = Pressure-fed hypergolic vacuum engine, like AJ10 family (Able, Delta, Apollo SPS...).
	minTf = 0.3
	minIgnitions = 1
	TechLevel
	{
		// AJ10-37
		techRequired = orbitalRocketry1956
		maxThrust = 42
		isp
		{
			key = 0 271
			key = 1 240
		}
		PROPELLANT
		{
			name = UDMH
			ratio = 0.406
			DrawGauge = True
		}
		PROPELLANT
		{
			name = IWFNA
			ratio = 0.594
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 0.2
		}
		pressureFed = true
		maxIgnitions = 1
		mass = 0.1
		entryCost = 7700 // original is 11000, AJ10-27, HydrazineFuel.  For now we'll just assume you've unlocked the -27 or equivalent proc-B.
		entryCost = HydrazineFuel
		cost = 129.8
		toolCost = 4283 // yields ~3300 for an AJ10-27
	}
	TechLevel
	{
		// AJ10-42
		techRequired = orbitalRocketry1958
		maxThrust = 42
		isp
		{
			key = 0 267
			key = 1 238
		}
		PROPELLANT
		{
			name = UDMH
			ratio = 0.406
			DrawGauge = True
		}
		PROPELLANT
		{
			name = IWFNA
			ratio = 0.594
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 0.2
		}
		pressureFed = true
		maxIgnitions = 1
		mass = 0.0971
		entryCost = 1400 // 2000
		cost = 113.6
		toolCost = 4328 // yields ~600 to upgrade from an AJ10-37
	}
	TechLevel
	{
		// AJ10-101A
		techRequired = orbitalRocketry1959
		maxThrust = 43
		isp
		{
			key = 0 270
			key = 1 240
		}
		PROPELLANT
		{
			name = UDMH
			ratio = 0.406
			DrawGauge = True
		}
		PROPELLANT
		{
			name = IWFNA
			ratio = 0.594
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 0.2
		}
		pressureFed = true
		maxIgnitions = 1
		mass = 0.098
		entryCost = 700 // 1000
		cost = 136.8
		toolCost = 3917 // yields ~300 to continue upgrading from AJ10-37
	}
	TechLevel
	{
		// AJ10-142
		techRequired = orbitalRocketry1960
		maxThrust = 44
		isp
		{
			key = 0 270
			key = 1 240
		}
		PROPELLANT
		{
			name = UDMH
			ratio = 0.406
			DrawGauge = True
		}
		PROPELLANT
		{
			name = IWFNA
			ratio = 0.594
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 0.2
		}
		pressureFed = true
		maxIgnitions = 1
		mass = 0.0978
		entryCost = 1050 // 1500, AJ10-42
		cost = 225
		toolCost = 3734 // yields ~450 to continue upgrading from AJ10-37
	}
	TechLevel
	{
		// AJ10-104 (but without the unlimited ignitions)
		techRequired = orbitalRocketry1961 // Should actually be 1960, but we dont want 2 nodes in one tech
		maxThrust = 46
		isp
		{
			key = 0 278
			key = 1 215
		}
		PROPELLANT
		{
			name = UDMH
			ratio = 0.4281
			DrawGauge = True
		}
		PROPELLANT
		{
			name = IRFNA-III
			ratio = 0.5719
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 0.2
		}
		pressureFed = true
		maxIgnitions = 4
		mass = 0.112
		entryCost = 10500 // 25000, AJ10-101A.  But we don't have unl. ignitions. so go with 15000
		cost = 207.6
		toolCost = 9286 // yields ~4500 to continue upgrading from AJ10-37
	}
	TechLevel
	{
		// AJ10-138
		techRequired = orbitalRocketry1964
		maxThrust = 47
		isp
		{
			key = 0 311
			key = 1 100
		}
		PROPELLANT
		{
			name = Aerozine50
			ratio = 0.446
			DrawGauge = True
		}
		PROPELLANT
		{
			name = NTO
			ratio = 0.554
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 0.25
		}
		pressureFed = true
		maxIgnitions = 8
		mass = 0.125
		entryCost = 10500 // 20000, AJ10-104. But this one is more limited, so only 15000
		cost = 279.3
		toolCost = 13783 // yields ~4500 to continue upgrading from AJ10-37
	}
	TechLevel
	{
		// AJ10-118F
		techRequired = orbitalRocketry1972
		maxThrust = 55
		isp
		{
			key = 0 315
			key = 1 215
		}
		PROPELLANT
		{
			name = Aerozine50
			ratio = 0.4654
			DrawGauge = True
		}

		PROPELLANT
		{
			name = NTO
			ratio = 0.5346
			DrawGauge = False
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 0.2
		}
		pressureFed = true
		maxIgnitions = 16 // practically infinite
		mass = 0.124
		entryCost = 2100 // 3000, AJ10-138, AJ10-118E
		cost = 342.6
		toolCost = 12055 // yields ~900 to continue upgrading from AJ10-37
	}
	TechLevel
	{
		// AJ10-118K
		techRequired = orbitalRocketry1986
		maxThrust = 57
		isp
		{
			key = 0 319.2
			key = 1 215
		}
		PROPELLANT
		{
			name = Aerozine50
			ratio = 0.4654
			DrawGauge = True
		}

		PROPELLANT
		{
			name = NTO
			ratio = 0.5346
			DrawGauge = False
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 0.2
		}
		pressureFed = true
		maxIgnitions = 16
		mass = 0.124
		entryCost = 3500 // 5000, AJ10-118F
		cost = 412.7
		toolCost = 11744 // yields ~1500 to continue upgrading from AJ10-37
	}
}

@PART[*]:HAS[@MODULE[ModuleSPEngine]:HAS[#familyLetter[D]],!MODULE[TestFlightInterop]]:BEFORE[zTestFlight]
{
	!TESTFLIGHT,*{}
	TESTFLIGHT
	{
		name = SPEngine-D-0 // based on AJ10-37
		ratedBurnTime = 115
		ignitionReliabilityStart = 0.888889
		ignitionReliabilityEnd = 0.977778
		cycleReliabilityStart = 0.555556
		cycleReliabilityEnd = 0.911111 // even on its best day, not a reliable engine.

		// transfer from both Aerobee and proc B
		techTransfer = SPEngine-B-2,SPEngine-B-1,SPEngine-B-0:10&AJ10-27,XASR-1,WAC-Corporal:10
	}
	TESTFLIGHT
	{
		name = SPEngine-D-1 // based on AJ10-42
		ratedBurnTime = 150
		ignitionReliabilityStart = 0.928571
		ignitionReliabilityEnd = 0.985714
		cycleReliabilityStart = 0.928571
		cycleReliabilityEnd = 0.985714 // Thor-Able I was pretty good.

		techTransfer = SPEngine-D-0:50&AJ10-37:25
	}
	TESTFLIGHT
	{
		name = SPEngine-D-2 // based on AJ10-101A
		ratedBurnTime = 150
		ignitionReliabilityStart = 0.916667
		ignitionReliabilityEnd = 0.983333
		cycleReliabilityStart = 0.916667
		cycleReliabilityEnd = 0.983333

		techTransfer = SPEngine-D-1,SPEngine-D-0:50&AJ10-42,AJ10-37:25
	}
	TESTFLIGHT
	{
		name = SPEngine-D-3 // based on AJ10-142, but with techTransfer from the D-2 even though the -142 doesn't transfer from the -101A.
		ratedBurnTime = 150
		ignitionReliabilityStart = 0.916667
		ignitionReliabilityEnd = 0.983333
		cycleReliabilityStart = 0.916667
		cycleReliabilityEnd = 0.983333

		techTransfer = SPEngine-D-2,SPEngine-D-1,SPEngine-D-0:50&AJ10-42,AJ10-37:25
	}
	TESTFLIGHT
	{
		name = SPEngine-D-4 // based on AJ10-104
		ratedBurnTime = 300
		ignitionReliabilityStart = 0.967742
		ignitionReliabilityEnd = 0.993548
		ignitionDynPresFailMultiplier = 0.1
		cycleReliabilityStart = 0.833333
		cycleReliabilityEnd = 0.966667

		techTransfer = SPEngine-D-3,SPEngine-D-2,SPEngine-D-1,SPEngine-D-0:50&AJ10-142,AJ10-42,AJ10-37:25
	}
	TESTFLIGHT
	{
		name = SPEngine-D-5 // based on AJ10-138
		ratedBurnTime = 450
		ignitionReliabilityStart = 0.992424
		ignitionReliabilityEnd = 0.998485
		cycleReliabilityStart = 0.893617
		cycleReliabilityEnd = 0.978723
		// only need to keep 4 generations as our generation penalty is 25%
		techTransfer = SPEngine-D-4,SPEngine-D-3,SPEngine-D-2,SPEngine-D-1:50&AJ10-104,AJ10-142,AJ10-42,AJ10-37:25
	}
	TESTFLIGHT
	{
		name = SPEngine-D-6 // based on AJ10-118F
		ratedBurnTime = 450
		ignitionReliabilityStart = 0.923077
		ignitionReliabilityEnd = 0.984615
		cycleReliabilityStart = 0.875000	// 1 failure out of 8 flights
		cycleReliabilityEnd = 0.975000
		techTransfer = SPEngine-D-5,SPEngine-D-4,SPEngine-D-3,SPEngine-D-2:50&AJ10-104,AJ10-142,AJ10-42:15
	}
	TESTFLIGHT
	{
		name = SPEngine-D-7 // based on AJ10-118K
		ratedBurnTime = 450
		ignitionReliabilityStart = 0.996094
		ignitionReliabilityEnd = 0.999219
		cycleReliabilityStart = 0.994152
		cycleReliabilityEnd = 0.998830
		techTransfer = SPEngine-D-6,SPEngine-D-5,SPEngine-D-4,SPEngine-D-3:50&AJ10-104,AJ10-142,AJ10-42:10
	}
}
